
Pred začetkom projekta sem skozi CLI s pomočjo npm naložil amplify. Nastavil sem nastavitve amplifya z ukazom amplify configure, nato pa začel nov projekt z amplify init. Sprva sem dodal Cognito za avtentikacijo z ukazom amplify auth add. Pri avtentikaciji sem dobil error: AuthError - Error: Amplify has not been configured correctly, čeprav sem pravilno nastavil konfiguracijo. Poskusil sem spremeniti aws-exports.js v aws-exports.ts in z nekaj drugimi rešitvami, vendar neuspešno, zato sem v main.ts dodal lastno konfiguracijo Auth-a. Za prijavo v aplikacijo je potrebno potrditi e-naslov. S pomočjo ukaza amplify hosting add sem nato izgradil server. API sem zgradil z ukazom amplify api add, kjer sem nato dodal poti /blogs/{id}/comments/{comment_id}, kjer sem za bloge in komentarje ločil lambda funkciji. Funkcije sem izgradil v jeziku Node.js. Ustvaril sem novo tabelo, kjer je bil ključ sestavljen iz dveh delov. V tabelo sem shranjeval bloge z istim partition in sort ključem z začetnico BLOG-, partition ključ komentarjev je bil identifikacijska številka bloga, sort ključ pa id. številka komentarja. Za vsak komentar sem shranil tudi vrsto staršev (komentarjev). Všečki so imeli za partition ključ id komentarja, sort ključ pa je bil sestavljen iz predpone LIKE-/DISL- in nato id uporabnika. Naletel sem na težavo z glavo CORS, ki sem jo uspel odstraniti preko aws konzole. Sprva sem večkrat popravil napake, a sem pozabil nov API tudi deployati. Sprva sem spisal lambda funkciji za pridobivanje in objavljanje blogov. Nato sem se sestavil frontend. V frontendu sem sestavil APIservice, BlogsService in AuthService, ki skrbijo za pravilno prenašanje podatkov in delovanje aplikacije. Ob posodabljanju lambda funkcij sem naletel na [naslednji eror](./error.JPG). Zanj sem porabil dva dni, kjer sem se igral z nastavitvami VPC serverjev in NAT gateway ter poskušal z brisanjem API-ja ter funkcij in s ponovnim začetkom. Na koncu je bil kriv pokvarjen modem, saj sem preko povezave mobile hotspot uspel z ukazom amplify push v nekaterih poskusih (slab signal) naložiti podatke na server. Zato sem moral ponovni API izgraditi s pomočjo spletne aws konzole in ga tako tudi ročno konfigurirati v main.ts, funkcije pa preko lambda konzole. Pri lambda funkcijah sem moral uporabiti tudi mapping vhodov namesto proxya, saj sem kljub vračanju podatkov v obliki { "isBase64Encoded": true|false, "statusCode": httpStatusCode, "headers": { "headerName": "headerValue", ... }, "body": "..."} dobil error malformed Lambda proxy response. Zgradil sem več ločenih funkcij, katerim sem dodal pravilne Policy-je za dodajanje/branje/odstranjevanje iz baze. Funkcije sem dodal v mapo Lambde, da si jih lahko ogledate. Nekaj težav sem imel tudi z ukazom publish. Sprva je vračal isti Timeout error, ki je opisan zgoraj, nato pa je naložil aplikacijo brez errorjev, vendar ni posodobil frontenda. Po ponovnem klicu publish čez nekaj časa se je pravilno naložil tudi frontend. Aplikacija je dostopna na linku: https://d2b06bf5ewuib7.cloudfront.net

